<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Murthadza Aznam">
<meta name="dcterms.date" content="2022-12-26">

<title>Masters Project - Reproducing Cui Xiang-Han et. al (2020)‘s ’Fast radio bursts: do repeaters and non-repeaters originate in statistically similar ensembles?’</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="Masters Project - Reproducing Cui Xiang-Han et. al (2020)‘s ’Fast radio bursts: do repeaters and non-repeaters originate in statistically similar ensembles?’">
<meta property="og:description" content="Is it possible that repeaters and non-repeaters have different mechanisms?">
<meta property="og:image" content="https://github.com/Thaza-Kun/sarjana/notebooks/jupyter-python.jpg">
<meta property="og:site-name" content="Masters Project">
<meta name="twitter:title" content="Masters Project - Reproducing Cui Xiang-Han et. al (2020)‘s ’Fast radio bursts: do repeaters and non-repeaters originate in statistically similar ensembles?’">
<meta name="twitter:description" content="Is it possible that repeaters and non-repeaters have different mechanisms?">
<meta name="twitter:image" content="https://github.com/Thaza-Kun/sarjana/notebooks/jupyter-python.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Masters Project</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Reproducing Cui Xiang-Han et. al (2020)‘s ’Fast radio bursts: do repeaters and non-repeaters originate in statistically similar ensembles?’</h1>
            <p class="subtitle lead">Is it possible that repeaters and non-repeaters have different mechanisms?</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Murthadza Aznam </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 26, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-the-data" id="toc-getting-the-data" class="nav-link active" data-scroll-target="#getting-the-data">0. Getting The Data</a>
  <ul class="collapse">
  <li><a href="#source" id="toc-source" class="nav-link" data-scroll-target="#source">0.1 Source</a></li>
  </ul></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing">1.0 Preprocessing</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">1.1 Parameters</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>📌 Goal: This notebook tries to reproduce the results from <a href="https://ui.adsabs.harvard.edu/abs/2021MNRAS.500.3275C/abstract">https://ui.adsabs.harvard.edu/abs/2021MNRAS.500.3275C/abstract</a>. As stated in the paper, verbatim</p>
<blockquote class="blockquote">
<p>We investigate the statistical classifications for the two groups of samples <strong>to see if the non-repeating and repeating FRBs have different origins</strong> by employing Anderson–Darling (A–D) test and Mann–WhitneyWilcoxon (M–W–W) test</p>
</blockquote>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns<span class="op">;</span> sns.set_theme()</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="getting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-data">0. Getting The Data</h2>
<section id="source" class="level3">
<h3 class="anchored" data-anchor-id="source">0.1 Source</h3>
<p>The data underlying said article are available in the references below:</p>
<ol type="1">
<li>Spitler et al.&nbsp;(<a href="https://www.nature.com/articles/nature17168">2016</a>);</li>
<li>CHIME/FRB Collaboration (<a href="https://www.nature.com/articles/s41586-018-0864-x">2019a</a>);</li>
<li>Kumar et al.&nbsp;(<a href="https://iopscience.iop.org/article/10.3847/2041-8213/ab5b08">2019</a>);</li>
<li>CHIME/FRB Collaboration (<a href="https://iopscience.iop.org/article/10.3847/2041-8213/ab4a80">2019b</a>);</li>
<li>Fonseca et al.&nbsp;(<a href="https://iopscience.iop.org/article/10.3847/2041-8213/ab7208">2020</a>).</li>
</ol>
<p>Some data of FRBs are taken from the data base of FRBCAT, available at http://www.frbcat.org/.</p>
<section id="non-repeaters" class="level4">
<h4 class="anchored" data-anchor-id="non-repeaters">0.1.1 Non-Repeaters</h4>
<p>However, I have not been able to effectively filter out repeater from the whole population in the FRBCAT Database. Therefore, I joined it with FRBSTATS where the repeater population has been listed on its <code>utc</code> column rounded to the nearest second.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Deprecated
</div>
</div>
<div class="callout-body-container callout-body">
<p>So I used the FRBSTATS<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> as a proxy with the described filters:</p>
<ul>
<li><code>width</code> &lt;= 35</li>
<li>is not identified as <code>repeater</code></li>
<li>The FRB is observed between FRBCAT’s minimum dan maximum <code>utc</code> datetime<br>
</li>
<li><code>telescope</code> is also available in the FRBCAT catalogue, except ‘CHIME/FRB’<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
</ul>
</div>
</div>
<p>Using the described filters, I have been able to obtain 88 data points. It is close to the papers sample of 80 ~ 91<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load FRBCAT Catalogue</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>frbcat <span class="op">=</span> pd.read_csv(<span class="st">"../data/raw/external/frbcat_20221227.csv"</span>, parse_dates<span class="op">=</span>[<span class="st">'utc'</span>]).rename(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>{</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rop_sampling_time'</span>: <span class="st">'sampling_time'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rop_bandwidth'</span>: <span class="st">'bandwidth_MHz'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'rop_centre_frequency'</span>: <span class="st">'center_freq_MHz'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>frbcat[<span class="st">'utc'</span>] <span class="op">=</span> frbcat[<span class="st">'utc'</span>].<span class="bu">round</span>(<span class="st">'S'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>frbcat <span class="op">=</span> frbcat[frbcat[<span class="st">'rmp_width'</span>] <span class="op">&lt;=</span> <span class="dv">35</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>frbcat.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 107 entries, 0 to 117
Data columns (total 14 columns):
 #   Column           Non-Null Count  Dtype         
---  ------           --------------  -----         
 0   frb_name         107 non-null    object        
 1   utc              107 non-null    datetime64[ns]
 2   telescope        107 non-null    object        
 3   rop_raj          107 non-null    object        
 4   rop_decj         107 non-null    object        
 5   rop_gl           107 non-null    float64       
 6   rop_gb           107 non-null    float64       
 7   sampling_time    106 non-null    float64       
 8   bandwidth_MHz    107 non-null    float64       
 9   center_freq_MHz  107 non-null    float64       
 10  rmp_dm           107 non-null    float64       
 11  rmp_dm_error     107 non-null    float64       
 12  rmp_width        107 non-null    float64       
 13  rmp_snr          104 non-null    float64       
dtypes: datetime64[ns](1), float64(9), object(4)
memory usage: 12.5+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load FRBSTATS catalogue and do appropriate filter</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A separate list is used because FRBCAT uses a different name</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>frbstats_telescope_names_available_in_frbcat <span class="op">=</span> [<span class="st">'Parkes'</span>, <span class="st">'Arecibo'</span>, <span class="st">'Pushchino'</span>, <span class="st">'FAST'</span>, <span class="st">'DSA'</span>, <span class="st">'CHIME'</span>, <span class="st">'WSRT/Apertif'</span>, <span class="st">'UTMOST'</span>, <span class="st">'VLA'</span>, <span class="st">'GBT'</span>, <span class="st">'ASKAP'</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>frbstats_float_columns <span class="op">=</span> [<span class="st">'l'</span>, <span class="st">'b'</span>, <span class="st">'frequency'</span>, <span class="st">'dm'</span>, <span class="st">'flux'</span>, <span class="st">'width'</span>, <span class="st">'fluence'</span>, <span class="st">'snr'</span>, <span class="st">'redshift'</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>repeaters_samples <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/external/FRBSTATS2022-11-23_repeaters.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>frbstats <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/external/FRBSTATS2022-11-23_population.csv'</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>[<span class="st">'utc'</span>], </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    dtype<span class="op">=</span>{telescope: <span class="bu">float</span> <span class="cf">for</span> telescope <span class="kw">in</span> frbstats_telescope_names_available_in_frbcat},</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    na_values<span class="op">=</span>[<span class="st">"-"</span>]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>frbstats[<span class="st">'utc'</span>].<span class="bu">round</span>(<span class="st">'S'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Label repeaters</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>frbstats[<span class="st">"repeater"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>frbstats.loc[frbstats[<span class="st">"frb"</span>].isin(repeaters_samples[<span class="st">"samples"</span>]),<span class="st">"repeater"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># !! Filter is deprecated</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># selected_data = frbstats[</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     (frbstats['repeater'] == False) &amp; </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     (frbstats["width"] &lt;= 35) &amp;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     (frbstats["telescope"].isin(frbstats_telescope_names_available_in_frbcat)) &amp;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     (frbstats['telescope'] != 'CHIME') &amp;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     (frbstats["utc"].between(frbcat["utc"].min(), frbcat["utc"].max()))</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>selected_data <span class="op">=</span> pd.merge(frbcat[[<span class="st">'utc'</span>, <span class="st">'sampling_time'</span>, <span class="st">'bandwidth_MHz'</span>, <span class="st">'center_freq_MHz'</span>, <span class="st">'rmp_width'</span>]], frbstats[frbstats[<span class="st">'repeater'</span>] <span class="op">==</span> <span class="va">False</span>], on<span class="op">=</span><span class="st">'utc'</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle NaN values</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>selected_data.loc[selected_data[<span class="st">'width'</span>].isna(), [<span class="st">'width'</span>]] <span class="op">=</span> selected_data[<span class="st">'rmp_width'</span>]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>selected_data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 84 entries, 0 to 83
Data columns (total 25 columns):
 #   Column             Non-Null Count  Dtype         
---  ------             --------------  -----         
 0   utc                84 non-null     datetime64[ns]
 1   sampling_time      83 non-null     float64       
 2   bandwidth_MHz      84 non-null     float64       
 3   center_freq_MHz    84 non-null     float64       
 4   rmp_width          84 non-null     float64       
 5   frb                84 non-null     object        
 6   mjd                84 non-null     float64       
 7   telescope          84 non-null     object        
 8   ra                 84 non-null     object        
 9   dec                84 non-null     object        
 10  l                  84 non-null     float64       
 11  b                  84 non-null     float64       
 12  frequency          84 non-null     float64       
 13  dm                 84 non-null     float64       
 14  flux               77 non-null     float64       
 15  width              84 non-null     float64       
 16  fluence            81 non-null     float64       
 17  snr                82 non-null     float64       
 18  reference          84 non-null     object        
 19  redshift           83 non-null     float64       
 20  redshift_measured  6 non-null      float64       
 21  ra_error           83 non-null     float64       
 22  dec_error          83 non-null     float64       
 23  dm_error           82 non-null     float64       
 24  repeater           84 non-null     bool          
dtypes: bool(1), datetime64[ns](1), float64(18), object(5)
memory usage: 18.5+ KB</code></pre>
</div>
</div>
<p>In order the accept that both these data describe the same sample, I plotted the overlap between our selected data and the original FRBCAT data.</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>frbcat_ <span class="op">=</span> frbcat.rename(columns<span class="op">=</span>{<span class="st">'frb_name'</span>:<span class="st">'frb'</span>,<span class="st">'rop_raj'</span>: <span class="st">'ra'</span>, <span class="st">'rop_decj'</span>: <span class="st">'dec'</span>, <span class="st">'rop_gb'</span>: <span class="st">'b'</span>, <span class="st">'rop_gl'</span>: <span class="st">'l'</span>, <span class="st">'rmp_width'</span>: <span class="st">'width'</span>, <span class="st">'rmp_dm'</span>: <span class="st">'dm'</span>, <span class="st">'rmp_snr'</span>: <span class="st">'snr'</span>})</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>frbcat_.loc[:, [<span class="st">'source'</span>]] <span class="op">=</span> <span class="st">'frbcat'</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>frbstats_ <span class="op">=</span> selected_data[[<span class="st">'frb'</span>, <span class="st">'utc'</span>, <span class="st">'telescope'</span>, <span class="st">'ra'</span>, <span class="st">'dec'</span>, <span class="st">'l'</span>, <span class="st">'b'</span>, <span class="st">'dm'</span>, <span class="st">'width'</span>, <span class="st">'snr'</span>]]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>frbstats_.loc[:, [<span class="st">'source'</span>]] <span class="op">=</span> <span class="st">'frbstats'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>frbpopulation_merged <span class="op">=</span> pd.concat([frbcat_, frbstats_])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>frbpopulation_merged, x<span class="op">=</span><span class="st">'utc'</span>, y<span class="op">=</span><span class="st">'width'</span>, style<span class="op">=</span><span class="st">'source'</span>, hue<span class="op">=</span><span class="st">'telescope'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x1c66dc687c0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06-repeaters-and-non-repeaters-statisticaly-similar-ensembles_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="repeaters" class="level4">
<h4 class="anchored" data-anchor-id="repeaters">0.1.2 Repeaters</h4>
<p>Data on repeaters are easy to obtain. The authors are kind enough to provide table on all 20 samples used in the study.</p>
<p><img src="xiang-han2020-table1.png" class="img-fluid"></p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xianghan <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/external/XiangHan2020_ensemble-repeaters.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="88">
<div class="cell-output cell-output-display" data-execution_count="88">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: right;">No.</th>
<th style="text-align: left;">Sources</th>
<th style="text-align: right;">Observed width (ms)</th>
<th style="text-align: right;">Intrinsic width (ms)</th>
<th style="text-align: right;">Flux density (Jy)</th>
<th style="text-align: right;">Fluence (Jy ms)</th>
<th style="text-align: right;">Distance (Gpc)</th>
<th style="text-align: left;">Refs.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FRB121102</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">4.78</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: left;">(1)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">FRB180814.J0422+73</td>
<td style="text-align: right;">23.45</td>
<td style="text-align: right;">23.43</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">22.57</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: left;">(2)(3)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">FRB171019</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">101.54</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: left;">(4)</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">FRB180916.J0158+65</td>
<td style="text-align: right;">5.27</td>
<td style="text-align: right;">5.16</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">FRB181030.J1054+73</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">FRB181128.J0456+63</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">FRB181119.J12+65</td>
<td style="text-align: right;">3.49</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">FRB190116.J1249+27</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">FRB181017.J1705+68</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">16.73</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">6.97</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">FRB190209.J0937+77</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">6.46</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">FRB190222.J2052+69</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">5.45</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: left;">(5)</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">FRB190208.J1855+46</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">FRB180908.J1232+74</td>
<td style="text-align: right;">3.83</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">FRB190604.J1435+53</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">FRB190212.J18+81</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">FRB190303.J1353+48</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">FRB190417.J1939+59</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">7.4</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">FRB190117.J2207+17</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.36</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">FRB190213.J02+20</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: left;">(6)</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">FRB190907.J08+46</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: left;">(6)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">1.0 Preprocessing</h2>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">1.1 Parameters</h3>
<p>We first process our data to uncover these parameters:</p>
<ol type="1">
<li>Pulse width</li>
<li>Radio Luminosity</li>
</ol>
<section id="pulse-width" class="level4">
<h4 class="anchored" data-anchor-id="pulse-width">1.1.1 Pulse Width</h4>
<p>Since the pulse width in the FRBCAT is the observed width, which is easily affected by dispersion, to study the pulse width more accurately, we need to introduce the intrinsic width that is estimated by equation: <span class="math display">\[
t_i = \sqrt{t^2_\text{obs} − t^2_\text{DM} − t^2_s}
\]</span> In the above formula, <span class="math inline">\(t_i(t_\text{obs})\)</span> is the intrinsic width (observed width), with <span class="math inline">\(t_s\)</span> being the sampling time that depends on the instrument, and <span class="math inline">\(t_\text{DM}\)</span> is the dispersion smearing time-scale as calculated in the following: <span class="math display">\[
t_\text{DM} = 8.3 \times 10^{−3} \text{DM}\frac{\Delta ν_\text{MHz}}{ν^3_\text{GHz}} ms,
\]</span> where DM is the dispersion measure, <span class="math inline">\(\Delta ν_\text{MHz}\)</span> is the channel bandwidth in the unit of MHz, and <span class="math inline">\(ν_\text{GHz}\)</span> is the central frequency in the unit of GHz. Therefore, the pulse width in the following text represents the intrinsic width.</p>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dispersion_smearing_timescale(dispersion_measure, bandwidth_MHz, center_freq_GHz) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">8.3e-6</span> <span class="op">*</span> dispersion_measure <span class="op">*</span> (bandwidth_MHz <span class="op">/</span> center_freq_GHz<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> instrinsic_width(observed_width, sampling_time, dispersion_measure, bandwidth_MHz, center_freq_GHz) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sqrt(<span class="bu">abs</span>((observed_width<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> dispersion_smearing_timescale(dispersion_measure, bandwidth_MHz, center_freq_GHz)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> sampling_time<span class="op">**</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>selected_data.loc[:, <span class="st">'intrinsic_width_ms'</span>] <span class="op">=</span> instrinsic_width(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    selected_data[<span class="st">'width'</span>], </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    selected_data[<span class="st">'sampling_time'</span>], </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    selected_data[<span class="st">'dm'</span>], </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    selected_data[<span class="st">'bandwidth_MHz'</span>], </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    selected_data[<span class="st">'center_freq_MHz'</span>]<span class="op">*</span><span class="fl">0.001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="radio-luminosity" class="level4">
<h4 class="anchored" data-anchor-id="radio-luminosity">1.1.2 Radio Luminosity</h4>


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://www.herta-experiment.org/frbstats/<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Even with the described filters, the CHIME/FRB telescope dominates the dataset making up &gt;500 data points while it is not that prominent in FBRCAT and also the total data points is less than 100<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The paper mentioned both numbers. The lower limit of 80 is mentioned in the conclusion but the upper limit of 91 is mentioned in the abstract. So I took it as a range instead.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>