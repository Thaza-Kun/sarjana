<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Murthadza Aznam">
<meta name="dcterms.date" content="2022-10-20">

<title>Masters Project - Reproducing Chen et. al.&nbsp;(2021)‚Äôs unsupervised machine learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="Masters Project - Reproducing Chen et. al.&nbsp;(2021)‚Äôs unsupervised machine learning">
<meta property="og:description" content="Using UMAP to reduce dimensions and HDBSCAN to cluster datapoints">
<meta property="og:image" content="https://github.com/Thaza-Kun/sarjana/notebooks/jupyter-python.jpg">
<meta property="og:site-name" content="Masters Project">
<meta name="twitter:title" content="Masters Project - Reproducing Chen et. al.&nbsp;(2021)‚Äôs unsupervised machine learning">
<meta name="twitter:description" content="Using UMAP to reduce dimensions and HDBSCAN to cluster datapoints">
<meta name="twitter:image" content="https://github.com/Thaza-Kun/sarjana/notebooks/jupyter-python.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Masters Project</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../README.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Reproducing Chen et. al.&nbsp;(2021)‚Äôs unsupervised machine learning</h1>
            <p class="subtitle lead">Using UMAP to reduce dimensions and HDBSCAN to cluster datapoints</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Murthadza Aznam </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 20, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-the-data" id="toc-getting-the-data" class="nav-link active" data-scroll-target="#getting-the-data">0. Getting the Data</a>
  <ul class="collapse">
  <li><a href="#source" id="toc-source" class="nav-link" data-scroll-target="#source">0.1 Source</a></li>
  <li><a href="#dataset-validation" id="toc-dataset-validation" class="nav-link" data-scroll-target="#dataset-validation">0.2 Dataset Validation</a></li>
  </ul></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing">1. Preprocessing</a>
  <ul class="collapse">
  <li><a href="#sample-dan-selection" id="toc-sample-dan-selection" class="nav-link" data-scroll-target="#sample-dan-selection">1.1 Sample dan Selection</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">1.2 Parameters</a></li>
  <li><a href="#observational-parameters" id="toc-observational-parameters" class="nav-link" data-scroll-target="#observational-parameters">1.2.1 Observational Parameters</a></li>
  <li><a href="#model-dependent-parameters" id="toc-model-dependent-parameters" class="nav-link" data-scroll-target="#model-dependent-parameters">1.2.2 Model Dependent Parameters</a></li>
  </ul></li>
  <li><a href="#dimension-reduction" id="toc-dimension-reduction" class="nav-link" data-scroll-target="#dimension-reduction">2. Dimension Reduction</a>
  <ul class="collapse">
  <li><a href="#split-test-and-training-data" id="toc-split-test-and-training-data" class="nav-link" data-scroll-target="#split-test-and-training-data">2.1 Split test and training data</a></li>
  <li><a href="#umap" id="toc-umap" class="nav-link" data-scroll-target="#umap">2.2 UMAP</a></li>
  </ul></li>
  <li><a href="#hdbscan" id="toc-hdbscan" class="nav-link" data-scroll-target="#hdbscan">3. HDBSCAN</a>
  <ul class="collapse">
  <li><a href="#calculation" id="toc-calculation" class="nav-link" data-scroll-target="#calculation">3.1 Calculation</a></li>
  <li><a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison">3.2 Comparison</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>üìå Goal: This notebook tries to reproduce the results from <a href="https://ui.adsabs.harvard.edu/abs/2022MNRAS.509.1227C/abstract">https://ui.adsabs.harvard.edu/abs/2022MNRAS.509.1227C/abstract</a>. As stated in the paper, verbatim</p>
<blockquote class="blockquote">
<p>Our goal is to <strong>map several observational and model-dependent parameters of each FRB to a 2D embedding plane</strong> by training the UMAP algorithm on the features of the training samples in CHIME/FRB dataset <strong>and finally identify possibly misclassified non-repeating FRBs</strong> which in fact have latent features of repeating FRBs. We define these possibly misclassified non-repeating FRBs as FRB repeater candidates in our paper.</p>
</blockquote>
</div>
</div>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> umap</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.time <span class="im">import</span> Time</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="getting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-data">0. Getting the Data</h2>
<section id="source" class="level3">
<h3 class="anchored" data-anchor-id="source">0.1 Source</h3>
<p>The paper uses data from CHIME/FRB Catalog with parameters calculated in <a href="https://doi.org/10.1093/mnras/stac065">Hashimoto et. al.&nbsp;2022</a>.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>catalog: pd.DataFrame <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/chimefrbcat1_Hashimoto_2022.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>catalog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>tns_name</th>
      <th>previous_name</th>
      <th>repeater_name</th>
      <th>ra</th>
      <th>ra_err</th>
      <th>ra_notes</th>
      <th>dec</th>
      <th>dec_err</th>
      <th>dec_notes</th>
      <th>gl</th>
      <th>...</th>
      <th>weight_fluence_error_m</th>
      <th>weight</th>
      <th>weight_error_p</th>
      <th>weight_error_m</th>
      <th>weighted_logrhoA</th>
      <th>weighted_logrhoA_error_p</th>
      <th>weighted_logrhoA_error_m</th>
      <th>weighted_logrhoB</th>
      <th>weighted_logrhoB_error_p</th>
      <th>weighted_logrhoB_error_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FRB20180725A</td>
      <td>180725.J0613+67</td>
      <td>-9999</td>
      <td>93.42</td>
      <td>0.04</td>
      <td>-9999</td>
      <td>67.10</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>147.29</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FRB20180727A</td>
      <td>180727.J1311+26</td>
      <td>-9999</td>
      <td>197.70</td>
      <td>0.10</td>
      <td>-9999</td>
      <td>26.40</td>
      <td>0.30</td>
      <td>-9999</td>
      <td>24.76</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FRB20180729A</td>
      <td>180729.J1316+55</td>
      <td>-9999</td>
      <td>199.40</td>
      <td>0.10</td>
      <td>-9999</td>
      <td>55.58</td>
      <td>0.08</td>
      <td>-9999</td>
      <td>115.26</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FRB20180729B</td>
      <td>180729.J0558+56</td>
      <td>-9999</td>
      <td>89.90</td>
      <td>0.30</td>
      <td>-9999</td>
      <td>56.50</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>156.90</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FRB20180730A</td>
      <td>180730.J0353+87</td>
      <td>-9999</td>
      <td>57.39</td>
      <td>0.03</td>
      <td>-9999</td>
      <td>87.20</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>125.11</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>594</th>
      <td>FRB20190701A</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>277.50</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>59.00</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>88.29</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>595</th>
      <td>FRB20190701B</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>302.90</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>80.20</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>112.88</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>596</th>
      <td>FRB20190701C</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>96.40</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>81.60</td>
      <td>0.30</td>
      <td>-9999</td>
      <td>132.18</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>597</th>
      <td>FRB20190701D</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>112.10</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>66.70</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>149.28</td>
      <td>...</td>
      <td>0.000649</td>
      <td>1.361506</td>
      <td>0.574701</td>
      <td>0.206776</td>
      <td>0.813142</td>
      <td>0.485293</td>
      <td>0.109293</td>
      <td>0.894742</td>
      <td>0.25519</td>
      <td>0.19035</td>
    </tr>
    <tr>
      <th>598</th>
      <td>FRB20190701E</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>138.60</td>
      <td>0.20</td>
      <td>-9999</td>
      <td>61.71</td>
      <td>0.04</td>
      <td>-9999</td>
      <td>153.27</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>599 rows √ó 107 columns</p>
</div>
</div>
</div>
</section>
<section id="dataset-validation" class="level3">
<h3 class="anchored" data-anchor-id="dataset-validation">0.2 Dataset Validation</h3>
<p>We first validate that the data is as described in the paper. According to the paper:</p>
<ol type="1">
<li><blockquote class="blockquote">
<p>The initial dataset includes 501 non-repeating FRB sub-bursts from 474 sources and 93 repeating FRB sub-bursts from 18 sources.</p>
</blockquote></li>
<li><blockquote class="blockquote">
<p>The catalogue includes 535 FRBs at a frequency range between 400 and 800 MHz from <strong>2018 July 25</strong> to <strong>2019 July 1</strong>. Since a repeating FRB source provides several FRBs and each FRB might include several sub-bursts, the actual number of applying subburst samples are 501 non-repeating + 93 repeating = 594 sub-bursts.</p>
</blockquote></li>
</ol>
<p>We can verify this using a simple dataframe method.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>start: <span class="bu">float</span> <span class="op">=</span> Time(<span class="st">'2018-07-25'</span>).mjd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>end: <span class="bu">float</span> <span class="op">=</span> Time(<span class="st">'2019-07-01'</span>).mjd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>interval: pd.Series <span class="op">=</span> (start <span class="op">&lt;=</span> catalog[<span class="st">'mjd_400'</span>]) <span class="op">&amp;</span> (catalog[<span class="st">'mjd_400'</span>] <span class="op">&lt;=</span> end)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>catalog: pd.DataFrame <span class="op">=</span> catalog[interval]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>repeating: pd.DataFrame <span class="op">=</span> catalog[(catalog[<span class="st">'repeater_name'</span>] <span class="op">!=</span> <span class="st">"-9999"</span>)]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>non_repeating: pd.DataFrame <span class="op">=</span> catalog[(catalog[<span class="st">'repeater_name'</span>] <span class="op">==</span> <span class="st">"-9999"</span>)]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total repeaters</span><span class="ch">\t\t</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(repeating)<span class="sc">}</span><span class="ss">"</span>,<span class="ss">f"Total non-repeaters</span><span class="ch">\t</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(non_repeating)<span class="sc">}</span><span class="ss">"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total sub-bursts</span><span class="ch">\t</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(repeating) <span class="op">+</span> <span class="bu">len</span>(non_repeating)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total repeaters     : 93
Total non-repeaters : 501
Total sub-bursts    : 594</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>TODO Apply filter to get the number of sources. This filter only gets the number of sub bursts.</p>
</div>
</div>
<div class="callout-question callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does the authors mean by ‚ÄúThe catalogue includes 535 FRBs‚Äù? I could not think of a filter that fits the description.</p>
</div>
</div>
</section>
</section>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">1. Preprocessing</h2>
<section id="sample-dan-selection" class="level3">
<h3 class="anchored" data-anchor-id="sample-dan-selection">1.1 Sample dan Selection</h3>
<p>These are the criteria:</p>
<ol type="1">
<li>Observed between 2018 July 25 to 2019 July 1. (Already filtered in <a href="#02-dataset-validation">Validation</a>)</li>
<li>We exclude the FRB sub-bursts which have neither <code>flux</code> nor <code>fluence</code> measurements.</li>
<li>The input data for unsupervised learning includes a total of 10 observational and 3 model-dependent parameters. (Described in <a href="#12-parameters">Parameters</a>)</li>
</ol>
</section>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">1.2 Parameters</h3>
</section>
<section id="observational-parameters" class="level3">
<h3 class="anchored" data-anchor-id="observational-parameters">1.2.1 Observational Parameters</h3>
<p>The parameters selected by the paper is as follows: - Boxcar Width <code>bc_width</code> - Width of Sub-Burst <code>width_fitb</code> - Flux <code>flux</code> - Fluence <code>fluence</code> - Scattering Time <code>scat_time</code> - Spectral Index <code>sp_idx</code> - Spectral Running <code>sp_run</code> - Highest Frequency <code>high_freq</code> - Lowest Frequency <code>low_freq</code> - Peak Frequency <code>peak_freq</code></p>
</section>
<section id="model-dependent-parameters" class="level3">
<h3 class="anchored" data-anchor-id="model-dependent-parameters">1.2.2 Model Dependent Parameters</h3>
<ul>
<li>Redshift <code>z</code></li>
<li>Radio Energy <code>logE_rest_400</code></li>
<li>Rest-Frame Intrinsic Duration <code>logsubw_int_rest</code></li>
</ul>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>params : List[<span class="bu">str</span>] <span class="op">=</span> [</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Observational</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bc_width"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"width_fitb"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"flux"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fluence"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"scat_time"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sp_idx"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sp_run"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"high_freq"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"low_freq"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"peak_freq"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model dependent</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"z"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logE_rest_400"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logsubw_int_rest"</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>identifiers: List[<span class="bu">str</span>] <span class="op">=</span> [</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tns_name"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"repeater_name"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>dropna_subset <span class="op">=</span> [<span class="st">'flux'</span>, <span class="st">'fluence'</span>, <span class="st">'logE_rest_400'</span>]</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>non_repeating <span class="op">=</span> non_repeating[[<span class="op">*</span>params, <span class="op">*</span>identifiers]]</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>repeating <span class="op">=</span> repeating[[<span class="op">*</span>params, <span class="op">*</span>identifiers]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="dimension-reduction" class="level2">
<h2 class="anchored" data-anchor-id="dimension-reduction">2. Dimension Reduction</h2>
<section id="split-test-and-training-data" class="level3">
<h3 class="anchored" data-anchor-id="split-test-and-training-data">2.1 Split test and training data</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test, train <span class="op">=</span> train_test_split(repeating, test_size<span class="op">=</span><span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to be trained</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>selected <span class="op">=</span> pd.concat([train, non_repeating]).dropna(subset<span class="op">=</span>dropna_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="umap" class="level3">
<h3 class="anchored" data-anchor-id="umap">2.2 UMAP</h3>
<p>Parameters:</p>
<ol type="1">
<li><code>n_neighbors = 8</code>
<ul>
<li>it controls how UMAP balances between the local structure and the global structure of the data manifolds</li>
</ul></li>
<li><code>n_components = 2</code>
<ul>
<li>the resulting dimensionality of the reduced dimension</li>
</ul></li>
<li><code>min_dist = 0.1</code>
<ul>
<li>to prevent the resulting low dimensional projections clumping together</li>
</ul></li>
</ol>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model: umap.UMAP <span class="op">=</span> umap.UMAP(n_neighbors<span class="op">=</span><span class="dv">8</span>, n_components<span class="op">=</span><span class="dv">2</span>, min_dist<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">map</span> <span class="op">=</span> model.fit(selected[params])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>test_map <span class="op">=</span> <span class="bu">map</span>.transform(test[params])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>selected[<span class="st">'x'</span>] <span class="op">=</span> <span class="bu">map</span>.embedding_[:, <span class="dv">0</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>selected[<span class="st">'y'</span>] <span class="op">=</span> <span class="bu">map</span>.embedding_[:, <span class="dv">1</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>selected[<span class="st">'color'</span>] <span class="op">=</span> [<span class="st">'non-repeater'</span> <span class="cf">if</span> name <span class="op">==</span> <span class="st">'-9999'</span> <span class="cf">else</span> <span class="st">'repeater (train)'</span> <span class="cf">for</span> name <span class="kw">in</span> selected[<span class="st">'repeater_name'</span>]]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>selected <span class="op">=</span> selected.sort_values(by<span class="op">=</span>[<span class="st">'color'</span>])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'x'</span>] <span class="op">=</span> test_map[:,<span class="dv">0</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'y'</span>] <span class="op">=</span> test_map[:,<span class="dv">1</span>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>test[<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'repeater (test)'</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>to_plot <span class="op">=</span> pd.concat([selected, test])</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'dark'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">'paper'</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>to_plot, kind<span class="op">=</span><span class="st">'scatter'</span>, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, hue<span class="op">=</span><span class="st">'color'</span>, hue_order<span class="op">=</span>[<span class="st">'non-repeater'</span>,<span class="st">'repeater (train)'</span>,<span class="st">'repeater (test)'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x1dff54e50d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-UMAP-HDBSCAN_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="hdbscan" class="level2">
<h2 class="anchored" data-anchor-id="hdbscan">3. HDBSCAN</h2>
<p>We now perform HDBSCAN to cluster data based on the dimensionally reduced data from UMAP.</p>
<section id="calculation" class="level3">
<h3 class="anchored" data-anchor-id="calculation">3.1 Calculation</h3>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hdbscan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>const <span class="op">=</span> <span class="fl">0.485</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>clus_size <span class="op">=</span> <span class="bu">round</span>(const <span class="op">*</span> to_plot.shape[<span class="dv">1</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>model_ <span class="op">=</span> hdbscan.HDBSCAN(clus_size)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>to_plot[<span class="st">'hdbscan'</span>] <span class="op">=</span> model_.fit_predict(to_plot[[<span class="st">'x'</span>, <span class="st">'y'</span>]])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>to_plot <span class="op">=</span> to_plot.sort_values(by<span class="op">=</span><span class="st">'hdbscan'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>to_plot[<span class="st">'hdbscan'</span>] <span class="op">=</span> to_plot[<span class="st">'hdbscan'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>to_plot, kind<span class="op">=</span><span class="st">'scatter'</span>, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, hue<span class="op">=</span><span class="st">'hdbscan'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x1df8adc3340&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-UMAP-HDBSCAN_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="comparison" class="level3">
<h3 class="anchored" data-anchor-id="comparison">3.2 Comparison</h3>
<p>In this section we present the data from <a href="https://ui.adsabs.harvard.edu/abs/2022MNRAS.509.1227C/abstract">Chen et al (2021)</a>.</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>chen2021 <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/CHIME_FRB_ML_classification.csv'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>chen2021[<span class="st">'source'</span>] <span class="op">=</span> <span class="st">'chen et al 2021'</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>chen2021, kind<span class="op">=</span><span class="st">'scatter'</span>, x<span class="op">=</span><span class="st">'embedding_x'</span>, y<span class="op">=</span><span class="st">'embedding_y'</span>, hue<span class="op">=</span><span class="st">'group'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x1df8b491fa0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-UMAP-HDBSCAN_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As you can see, Chen et al (2021) contains 9 clusters while the one we did have 12 clusters. The number of clusters itself is irrelevant but the size of clusters is. What we want to know is whether or not we can replicate the classification of repeater clusters from non-repeater clusters.</p>
<p>A cluster is considered repeater cluster is the total number of more than 10% repeating FRB exists in the cluster. Other FRBs inside the repeater cluster is determined to be ‚Äòpotentially‚Äô repeating. Then, we compare the division between this notebook and Chen et al (2021).</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining repeater clusters (&gt;10% is repeater FRB)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>this <span class="op">=</span> to_plot[[<span class="st">'tns_name'</span>,<span class="st">'x'</span>,<span class="st">'y'</span>, <span class="st">'hdbscan'</span>, <span class="st">'color'</span>]].rename(columns<span class="op">=</span>{<span class="st">'x'</span>: <span class="st">'embedding_x'</span>, <span class="st">'y'</span>:<span class="st">'embedding_y'</span>, <span class="st">'hdbscan'</span>: <span class="st">'label'</span>, <span class="st">'color'</span>: <span class="st">'repeater'</span>})</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>this[<span class="st">'source'</span>] <span class="op">=</span> <span class="st">'calculated'</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>this[<span class="st">'repeater'</span>] <span class="op">=</span> [<span class="va">False</span> <span class="cf">if</span> name <span class="op">==</span> <span class="st">'non-repeater'</span> <span class="cf">else</span> <span class="va">True</span> <span class="cf">for</span> name <span class="kw">in</span> this[<span class="st">'repeater'</span>]]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> this.groupby(<span class="st">'label'</span>).aggregate(<span class="st">'mean'</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>a[<span class="st">'group'</span>] <span class="op">=</span> [<span class="st">'repeater_cluster'</span> <span class="cf">if</span> row <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="st">'other_cluster'</span> <span class="cf">for</span> row <span class="kw">in</span> a[<span class="st">'repeater'</span>]]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>a.reset_index()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>this <span class="op">=</span> this.merge(a[[<span class="st">'group'</span>]], on<span class="op">=</span><span class="st">'label'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename groups to only separate repeater clusters from other clusters</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>chen2021[<span class="st">'group'</span>] <span class="op">=</span> chen2021[<span class="st">'group'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[:<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>data: pd.DataFrame <span class="op">=</span> pd.concat([this, chen2021])</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>data, kind<span class="op">=</span><span class="st">'scatter'</span>, x<span class="op">=</span><span class="st">'embedding_x'</span>, y<span class="op">=</span><span class="st">'embedding_y'</span>, hue<span class="op">=</span><span class="st">'group'</span>, col<span class="op">=</span><span class="st">'source'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x1df8b23fa60&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="02-UMAP-HDBSCAN_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The division fairly replicates the one from Chen et al.&nbsp;(2021). However, some of the top left corner of the embedding is not classified as repeater in this notebook while it is in Chen et al.&nbsp;(2021). We can continue analysis with more graphs from Chen et al.&nbsp;(2021).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>